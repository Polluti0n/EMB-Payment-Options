import{templates}from"./templates.js";import{renderFormFields}from"./form.js";import{updatePreview}from"./preview.js";import{pasteToOutlook}from"./outlook.js";Office.onReady(function(){var e=document.getElementById("templateSelect");document.getElementById("sideload-msg").style.display="none",Object.keys(templates).forEach(function(t){var n=document.createElement("option");n.value=t,n.textContent=templates[t].name,e.appendChild(n)}),renderFormFields(e.value),updatePreview();var t=document.getElementById("imageUploadContainer"),n=document.getElementById("imageUpload"),o=null,a=function(){"keyFob"===e.value?t.style.display="block":t.style.display="none"};e.addEventListener("change",function(){renderFormFields(e.value),updatePreview(),a()}),a(),n.addEventListener("change",function(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(e){o=e.target.result,console.log("Selected image:",o)},n.readAsDataURL(t)}}),document.getElementById("pasteButton").addEventListener("click",function(){pasteToOutlook(e.value,o)})});