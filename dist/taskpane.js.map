{"version":3,"file":"taskpane.js","mappings":"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","sources":["webpack://office-addin-taskpane-js/webpack/bootstrap","webpack://office-addin-taskpane-js/webpack/runtime/define property getters","webpack://office-addin-taskpane-js/webpack/runtime/hasOwnProperty shorthand","webpack://office-addin-taskpane-js/./src/taskpane/templates.js","webpack://office-addin-taskpane-js/./src/taskpane/preview.js","webpack://office-addin-taskpane-js/./src/taskpane/form.js","webpack://office-addin-taskpane-js/./src/taskpane/outlook.js","webpack://office-addin-taskpane-js/./src/taskpane/taskpane.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","export const logoBase64 = \"data:image/png;base64,...\"; // Replace with actual base64 logo\r\n\r\nfunction baseTemplate(content, v) {\r\n  return `<!doctype html>\r\n<html lang=\"en\">\r\n  <head>\r\n    <meta charset=\"utf-8\">\r\n    <title>${v.documentName}</title>\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n  </head>\r\n  <body style=\"margin: 0; padding: 24px 0; background-color: #f4f6f8;\">\r\n    <div style=\"display: none; max-height: 0; overflow: hidden; font-size: 1px; line-height: 1px; color: #f4f6f8;\">\r\n      ${v.documentShortText || ''}\r\n    </div>\r\n    <table bgcolor=\"#E6E7E8\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\">\r\n      <tbody>\r\n        <tr>\r\n          <td style=\"height: 24px; font-size: 24px; line-height: 24px; padding: 18px 24px\">&nbsp;</td>\r\n        </tr>\r\n        <tr>\r\n          <td valign=\"top\">\r\n            <table role=\"presentation\" width=\"650\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" align=\"center\" style=\"width: 650px; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.06);\">\r\n              <tr>\r\n                <td style=\"background-color: #0c233f; padding: 18px 24px;\">\r\n                  <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\r\n                    <tr>\r\n                      <td style=\"color: #ffffff; font-family: Arial, Helvetica, sans-serif; font-size: 18px; font-weight: 700; line-height: 1.2; padding-bottom: 0px;\" align=\"left\" valign=\"middle\">\r\n                        <img src=\"https://i.imgur.com/4Bfswoj.png\" alt=\"EMB Management\" height=\"40\" style=\"display: block; border: 0; max-width: 180px; height: auto;\">\r\n                      </td>\r\n                      <td align=\"right\" valign=\"middle\" style=\"color: #cfe3fb; font-family: Arial, Helvetica, sans-serif; font-size: 12px; font-weight: 400; line-height: 1.4;\">\r\n                        ${v.documentName || ''}\r\n                      </td>\r\n                    </tr>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n              <tr>\r\n                <td style=\"padding: 30px 40px; color: #333333; font-family: Arial, sans-serif; font-size: 15px; line-height: 1.6;\">\r\n                  ${content}\r\n                </td>\r\n              </tr>\r\n            </table>\r\n            <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\">\r\n              <tr>\r\n                <td align=\"center\" style=\"padding: 24px 0 0 0;\">\r\n                  <table role=\"presentation\" width=\"650\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" align=\"center\" style=\"width: 650px;\">\r\n                    <tr>\r\n                      <td style=\"font-family: Arial, sans-serif; font-size: 12px; color: #777777; padding: 10px 40px; text-align: center;\">\r\n                        <p style=\"margin: 0;\">This email may contain confidential information intended only for the recipient. If you are not the intended recipient, please delete this message.</p>\r\n                      </td>\r\n                    </tr>\r\n                  </table>\r\n                </td>\r\n              </tr>\r\n            </table>\r\n          </td>\r\n        </tr>\r\n      </tbody>\r\n    </table> \r\n  </body>\r\n</html>`;\r\n}\r\n\r\nexport const templates = {\r\n  payment: {\r\n    name: \"Payment Options\",\r\n    subject: v => `Payment Option Information for ${v.associationName}`,\r\n    documentName: \"Payment Option Information\",\r\n    documentShortText: v => `Payment option information for ${v.associationName}, account ${v.accountNumber}`,\r\n    variables: [\r\n      { name: \"propertyName\", type: \"text\" },\r\n      { name: \"ownerName\", type: \"text\" },\r\n      { name: \"associationName\", type: \"text\" },\r\n      { name: \"accountNumber\", type: \"text\" },\r\n      { name: \"amountDue\", type: \"text\" }\r\n    ],\r\n    body: v => baseTemplate(`\r\n        <h2 style=\"font-family: Arial, sans-serif; margin-top:0;\">Account Balance Information</h2>\r\n        <p>Dear ${v.ownerName},</p>\r\n        <p>Below are the payment options available for <strong>${v.associationName}</strong>. Please be sure to reference your account number <strong>${v.accountNumber}</strong> with all payments.</p>\r\n\r\n        <div style=\"font-size: 16px; font-weight: bold; margin: 20px 0; padding: 15px; background-color: #f8fafc; border-left: 4px solid #0b5cab; color: #333;\">\r\n          Current Amount Due: $${v.amountDue}\r\n        </div>\r\n\r\n        <div style=\"border-top: 1px solid #e6edf5; margin: 30px 0;\"></div>\r\n        <h2 style=\"font-family: Arial, sans-serif;\"><img src=\"https://img.icons8.com/?size=24&id=18635&format=png&color=000000\" alt=\"Mail\" style=\"vertical-align: middle; margin: 0px 8px 0px 0px;\"/> Mailing Payments</h2>\r\n        <p>Please ensure checks are made payable to <strong>${v.associationName}</strong>. Be sure to include your account number on the memo/notes line. Any payment received without an account number may be returned as “Unable to Locate Account.”</p>\r\n        <p>Mail payments to:</p>\r\n        <div style=\"border:1px solid #0c233f; padding:10px 20px; display:inline-block; margin:10px 0;\">\r\n          ${v.associationName}<br>c/o EMB Management<br>PO Box 45450<br>San Francisco, CA 94145-0450\r\n        </div>\r\n\r\n        <div style=\"border-top: 1px solid #e6edf5; margin: 30px 0;\"></div>\r\n        <h2 style=\"font-family: Arial, sans-serif;\"><img src=\"https://img.icons8.com/?size=24&id=6Rw34qscHREa&format=png&color=000000\" alt=\"ACH\" style=\"vertical-align: middle; margin: 0px 8px 0px 0px;\"/> Automatic Debit (ACH/DD)</h2>\r\n        <p>With ACH, your monthly assessment is automatically drafted from your bank account between the 5th–10th each month. This option is <strong>free of charge</strong> and ensures you never miss a payment or risk late fees.</p>\r\n        <table cellpadding=\"0\" cellmargin=\"0\" border=\"0\" height=\"44\" width=\"250\" style=\"border-collapse: collapse; border:5px solid ##0b5cab\">\r\n          <tr>\r\n            <td bgcolor=\"##0b5cab\" valign=\"middle\" align=\"center\" width=\"174\">\r\n              <div style=\"font-size: 18px; color: #ffffff; line-height: 1; margin: 0; padding: 0; mso-table-lspace:0; mso-table-rspace:0;\">\r\n                <a href=\"https://drive.google.com/file/d/1oEAdpHZpMgn_Dfh2cCc43qALZQsX5o8W/view?usp=sharing\" style=\"text-decoration: none; color: #ffffff; border: 0; font-family: Arial, arial, sans-serif; mso-table-lspace:0; mso-table-rspace:0;\" border=\"0\">DOWNLOAD ACH FORM</a>\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        </table>\r\n        <p>Please complete the form and return it with a voided check. For activation by next month’s assessment, it must be received by the 20th of the current month. ACH will only pull the current monthly assessment amount due. If your account has a balance beyond the monthly assessment, you must make a one-time payment using another option.</p>\r\n\r\n        <div style=\"border-top: 1px solid #e6edf5; margin: 30px 0;\"></div>\r\n        <h2 style=\"font-family: Arial, sans-serif;\"><img src=\"https://img.icons8.com/?size=24&id=VbL8v3mm1qyp&format=png&color=000000\" alt=\"Bill Pay\" style=\"vertical-align: middle; margin: 0px 8px 0px 0px;\"/> Bill Pay</h2>\r\n        <p>Bill Pay can be set up through your financial institution or online at <a href=\"https://app.townsq.io/login\">TownSq.io</a>. Please allow 5–7 business days for processing. Make checks payable to <strong>${v.associationName}</strong>, and include your last name/unit number (if applicable) and your account number on the memo line.</p>\r\n        <p>Mail to the same address listed above.</p>\r\n\r\n        <div style=\"border-top: 1px solid #e6edf5; margin: 30px 0;\"></div>\r\n        <h2 style=\"font-family: Arial, sans-serif;\"><img src=\"https://i.imgur.com/v1wViYe.png\" style=\"width:18px;padding:4px; vertical-align: middle; margin: 0px 8px 0px 0px;\" alt=\"Online\"/> Online Payments (TownSq)</h2>\r\n        <p>One-time or recurring payments may be made through <a href=\"https://app.townsq.io/registration/account-number\">TownSq.io</a> using a credit/debit card or checking/savings account. Registration is free.</p>\r\n        <p><strong>How to Register:</strong></p>\r\n        <ul>\r\n          <li style=\"line-height: 1.6;\">Enter the property’s zip code</li>\r\n          <li style=\"line-height: 1.6;\">Enter your account number (${v.accountNumber}) — no dashes or leading zeros</li>\r\n          <li style=\"line-height: 1.6;\">Review the terms of service and click \"Next\".</li>\r\n          <li style=\"line-height: 1.6;\">Verify your account details are correct and click \"Next\".</li>\r\n          <li style=\"line-height: 1.6;\">Finally, create a password for your account to finish registration.</li>\r\n        </ul>\r\n        <p><strong>TownSq Fees:</strong></p>\r\n        <ul>\r\n          <li style=\"line-height: 1.6;\">Bank Account (ACH): $2.95 per transaction</li>\r\n          <li style=\"line-height: 1.6;\">Credit/Debit Card: $2.95 + 3.5% of total</li>\r\n        </ul>\r\n        <p>Note: When using a bank account, the 3.5% fee will appear but then show a “cash discount” credit. The 3.5% will be waived in the final total. These fees are charged by TownSq (a third-party processor) and do not go to EMB Management. Using TownSq also ensures your payment information is processed securely.</p>\r\n\r\n        <div style=\"border-top: 1px solid #e6edf5; margin: 30px 0;\"></div>\r\n        <h2 style=\"font-family: Arial, sans-serif;\">Need Assistance?</h2>\r\n        <p>We’re here to help. Contact EMB Management at <a href=\"tel:4254527330\">(425) 452-7330</a> or reply to this email with any questions.</p>\r\n\r\n        <p>Thank you,<br><br>\r\n        <strong>EMB Management Team</strong><br>\r\n        <a href=\"https://www.google.com/maps/dir/?api=1&destination=Associa%20EMB%20Management\">\r\n        15301 NE 90th Street, Suite Q-170<br>\r\n        Redmond, WA 98052</a></p>`, v)\r\n  },\r\n\r\n  orderingResaleDocs: {\r\n    name: \"Ordering Resale Documents\",\r\n    subject: v => `Instructions for Ordering Resale Documents for ${v.associationName}`,\r\n    documentName: \"Ordering Resale Documents\",\r\n    documentShortText: v => `Instructions on how to order resale documents for ${v.associationName}.`,\r\n    variables: [\r\n      { name: \"recipientName\", type: \"text\" },\r\n      { name: \"associationName\", type: \"text\" }\r\n    ],\r\n    body: v => baseTemplate(`\r\n      <p style=\"margin-top:0;\">Hello ${v.recipientName},</p>\r\n      <p>Thank you for your recent request for the HOA documents for <strong>${v.associationName}</strong>. Resale certificates and questionnaires are handled through our Community Archives department.</p>\r\n      <p>Please follow the steps below to order the necessary documents.</p>\r\n\r\n      <div style=\"border-top: 1px solid #e6edf5; margin: 30px 0;\"></div>\r\n\r\n      <h2 style=\"font-family: Arial, sans-serif; margin-top:0;\">Step-by-Step Ordering Guide</h2>\r\n\r\n      <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" style=\"font-size: 15px;\">\r\n        <tr>\r\n          <td width=\"40\" style=\"vertical-align: top; font-size: 30px; font-weight: bold; color: #0b5cab; padding-right: 15px;\">1.</td>\r\n          <td style=\"vertical-align: top;\">\r\n            <p style=\"margin-top: 10px; margin-bottom: 20px;\">\r\n              Go to the EMB Management website at <a href=\"https://www.embmanagement.com\" target=\"_blank\" style=\"color:#0b5cab; text-decoration:none;\">www.embmanagement.com</a>. Click on the <strong>“Homeowner Resources”</strong> tab, and then click <strong>“Order Resale Documents”</strong>.\r\n            </p>\r\n            <img src=\"https://i.imgur.com/ifeECdx.png\" alt=\"Navigate to Order Resale Documents\" width=\"550\" style=\"max-width: 550px; height: auto; border: 1px solid #e6edf5; border-radius: 8px;\">\r\n          </td>\r\n        </tr>\r\n        <tr><td colspan=\"2\" style=\"height: 20px;\"></td></tr>\r\n        <tr>\r\n          <td width=\"40\" style=\"vertical-align: top; font-size: 30px; font-weight: bold; color: #0b5cab; padding-right: 15px;\">2.</td>\r\n          <td style=\"vertical-align: top;\">\r\n            <p style=\"margin-top: 10px; margin-bottom: 20px;\">\r\n              You will be connected to the Community Archives page. You will need to create an account. Registration is free. Enter your first name, last name, email, and a password, then click \"Sign Up\". You will be sent an email with a confirmation code to complete your registration.\r\n            </p>\r\n            <img src=\"https://i.imgur.com/TYpejIz.png\" alt=\"Community Archives Registration\" width=\"300\" style=\"max-width: 300px; height: auto; border: 1px solid #e6edf5; border-radius: 8px;\">\r\n          </td>\r\n        </tr>\r\n        <tr><td colspan=\"2\" style=\"height: 20px;\"></td></tr>\r\n        <tr>\r\n          <td width=\"40\" style=\"vertical-align: top; font-size: 30px; font-weight: bold; color: #0b5cab; padding-right: 15px;\">3.</td>\r\n          <td style=\"vertical-align: top;\">\r\n            <p style=\"margin-top: 10px; margin-bottom: 20px;\">\r\n              Once registered, you can find your community by typing the first three letters of the community name (<strong>${v.associationName}</strong>) in the search box and waiting for the name to appear. Select your community from the list.\r\n              <br><strong style=\"color: #c0392b;\">Note:</strong> Do not press the Enter or Space key after typing; wait for the information to populate.\r\n            </p>\r\n          </td>\r\n        </tr>\r\n        <tr><td colspan=\"2\" style=\"height: 20px;\"></td></tr>\r\n        <tr>\r\n          <td width=\"40\" style=\"vertical-align: top; font-size: 30px; font-weight: bold; color: #0b5cab; padding-right: 15px;\">4.</td>\r\n          <td style=\"vertical-align: top;\">\r\n            <p style=\"margin-top: 10px; margin-bottom: 20px;\">\r\n              A list of available documents and products will appear. Select the items you need to purchase to complete your order.\r\n            </p>\r\n          </td>\r\n        </tr>\r\n      </table>\r\n\r\n      <div style=\"border-top: 1px solid #e6edf5; margin: 30px 0;\"></div>\r\n\r\n      <h3 style=\"font-family: Arial, sans-serif;\">Frequently Asked Questions</h3>\r\n      <p style=\"margin-bottom: 5px;\"><strong>What is the order turnaround time?</strong></p>\r\n      <p style=\"margin-top:0;\">Standard processing time is 5-10 business days. If you need your order sooner, please choose the expedite option, which has a 9-32 business hour processing time.</p>\r\n\r\n      <p style=\"margin-bottom: 5px;\"><strong>What if I'm ordering a custom/lender-specific questionnaire?</strong></p>\r\n      <p style=\"margin-top:0;\">Please choose the \"Lender/Mortgage Questionnaire\" and follow the instructions to order a \"Custom Questionnaire.\" Send the custom questionnaire to <a href=\"mailto:Customforms@communityarchives.com\" style=\"color:#0b5cab; text-decoration:none;\">Customforms@communityarchives.com</a> and include your order number.</p>\r\n      \r\n      <div style=\"margin: 25px 0; padding: 20px; background-color: #f8fafc; border-radius: 8px; border: 1px solid #e6edf5;\">\r\n        <h4 style=\"margin-top:0; font-family: Arial, sans-serif;\">Need Help?</h4>\r\n        <p style=\"margin-bottom:0;\">If you need assistance with navigating the website, registering, or have questions about costs, current orders, or order status, please contact the Community Archives Customer Service department directly.</p>\r\n        <p style=\"margin-top:10px;\">\r\n          <strong>Email:</strong> <a href=\"mailto:customerservice@communityarchives.com\" style=\"color:#0b5cab; text-decoration:none;\">customerservice@communityarchives.com</a><br>\r\n          <strong>Phone:</strong> <a href=\"tel:1-833-462-3627\" style=\"color:#0b5cab; text-decoration:none;\">1-833-462-3627</a>\r\n        </p>\r\n      </div>\r\n    `, v)\r\n  },\r\n\r\n  receipt: {\r\n    name: \"Confirmed Receipt\",\r\n    subject: v => `Payment Receipt Confirmation for ${v.associationName}`,\r\n    documentName: \"Payment Receipt\",\r\n    documentShortText: v => `Receipt of $${v.amountPaid} from ${v.ownerName} for ${v.associationName}`,\r\n    variables: [\r\n      { name: \"propertyName\", type: \"text\" },\r\n      { name: \"ownerName\", type: \"text\" },\r\n      { name: \"associationName\", type: \"text\" },\r\n      { name: \"amountPaid\", type: \"text\" },\r\n      { name: \"paymentDate\", type: \"date\" }\r\n    ],\r\n    body: v => baseTemplate(`\r\n      <h2 style=\"font-family: Arial, sans-serif;\">Payment Confirmation</h2>\r\n      <p>Dear ${v.ownerName},</p>\r\n      <p>This is to confirm we received your payment of <strong>$${v.amountPaid}</strong> \r\n      for <strong>${v.associationName}</strong> on <strong>${v.paymentDate}</strong>.</p>\r\n      <p>Thank you for your timely payment.</p>\r\n    `, v)\r\n  },\r\n\r\n  resale: {\r\n    name: \"Resale Document Signature\",\r\n    subject: v => `Resale Document Signature Request for ${v.associationName}`,\r\n    documentName: \"Resale Document Request\",\r\n    documentShortText: v => `Signature request for ${v.ownerName} at ${v.propertyAddress}`,\r\n    variables: [\r\n      { name: \"propertyName\", type: \"text\" },\r\n      { name: \"ownerName\", type: \"text\" },\r\n      { name: \"associationName\", type: \"text\" },\r\n      { name: \"propertyAddress\", type: \"text\" },\r\n      { name: \"deadlineDate\", type: \"date\" }\r\n    ],\r\n    body: v => baseTemplate(`\r\n      <h2 style=\"font-family: Arial, sans-serif;\">Resale Document Signature Required</h2>\r\n      <p>Dear ${v.ownerName},</p>\r\n      <p>To proceed with the sale of <strong>${v.propertyAddress}</strong> in \r\n      <strong>${v.associationName}</strong>, please review and sign the attached resale documents by \r\n      <strong>${v.deadlineDate}</strong>.</p>\r\n      <p>If you have questions, contact our office immediately.</p>\r\n    `, v)\r\n  },\r\n\r\n  welcome: {\r\n    name: \"Welcome Packet\",\r\n    subject: v => `Welcome to ${v.associationName}!`,\r\n    documentName: \"Welcome Packet\",\r\n    documentShortText: v => `Welcome letter for ${v.ownerName} moving into ${v.associationName}`,\r\n    variables: [\r\n      { name: \"propertyName\", type: \"text\" },\r\n      { name: \"ownerName\", type: \"text\" },\r\n      { name: \"associationName\", type: \"text\" },\r\n      { name: \"moveInDate\", type: \"date\" }\r\n    ],\r\n    body: v => baseTemplate(`\r\n      <h2 style=\"font-family: Arial, sans-serif;\">Welcome to ${v.associationName}</h2>\r\n      <p>Dear ${v.ownerName},</p>\r\n      <p>Welcome! We’re excited to have you as part of our community starting <strong>${v.moveInDate}</strong>.</p>\r\n      <p>Your welcome packet is attached, which contains important information about community rules, amenities, and contacts.</p>\r\n    `, v)\r\n  },\r\n\r\n  keyFob: {\r\n    name: \"Key Fob Mailing\",\r\n    subject: v => `Key Fob Mailing Confirmation for ${v.associationName} Unit ${v.unitNumber}`,\r\n    documentName: `Key Fob Mailing Confirmation`,\r\n    documentShortText: v => `Confirmation that a new key fob has been mailed to ${v.residentName} at ${v.associationName} Unit ${v.unitNumber} on ${v.mailDate}`,\r\n    variables: [\r\n      { name: \"associationName\", type: \"text\" },\r\n      { name: \"unitNumber\", type: \"text\" },\r\n      { name: \"mailDate\", type: \"date\" },\r\n      { name: \"residentName\", type: \"text\" },\r\n      { name: \"keyFobId\", type: \"text\" },\r\n      { name: \"keyFobImage\", type: \"file\" }\r\n    ],\r\n    body: v => baseTemplate(`\r\n        <p style=\"margin:0 0 14px 0;\">Hello Board Members,</p>\r\n\r\n        <p style=\"margin:0 0 14px 0;\">\r\n          This is a confirmation that a new key fob has been mailed to a resident at\r\n          <strong>${v.associationName}</strong>, unit <strong>${v.unitNumber}</strong>, on <strong>${v.mailDate}</strong>.\r\n        </p>\r\n\r\n        <table role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" style=\"margin:16px 0; background:#f8fafc; border:1px solid #e6edf5; border-radius:10px;\">\r\n          <tr>\r\n            <td style=\"padding:16px 18px;\">\r\n              <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\">\r\n                <tr>\r\n                  <td class=\"stack\" style=\"vertical-align:top; width:60%;\">\r\n                    <p style=\"margin:0 0 8px 0; font:700 14px Arial, Helvetica, sans-serif; color:#0b5cab;\">\r\n                      Fulfillment Details\r\n                    </p>\r\n                    <p style=\"margin:0; font:400 14px Arial, Helvetica, sans-serif;\">\r\n                      Resident, <strong>${v.residentName}</strong><br>\r\n                      Unit, <strong>${v.unitNumber}</strong><br>\r\n                      Key Fob ID, <strong style=\"letter-spacing:0.5px;\">${v.keyFobId}</strong><br>\r\n                      Mail date, <strong>${v.mailDate}</strong>\r\n                    </p>\r\n                  </td>\r\n                  <td class=\"stack\" style=\"vertical-align:top; width:40%; text-align:right;\">\r\n                    <img src=\"${v.keyFobImage}\"\r\n                         width=\"220\"\r\n                         alt=\"Back of key fob showing ID ${v.keyFobId}\"\r\n                         style=\"max-width:220px; height:auto; border-radius:8px; border:1px solid #e6edf5; display:inline-block;\">\r\n                    <div style=\"font:12px Arial, Helvetica, sans-serif; color:#5b6b7a; margin-top:6px;\">\r\n                      Image, back of key fob for verification\r\n                    </div>\r\n                  </td>\r\n                </tr>\r\n              </table>\r\n            </td>\r\n          </tr>\r\n        </table>\r\n\r\n        <p style=\"margin:0 0 12px 0;\">\r\n          Action requested, please activate the key fob with ID <strong>${v.keyFobId}</strong> for unit <strong>${v.unitNumber}</strong>.\r\n        </p>\r\n\r\n        <p style=\"margin:0 0 18px 0; color:#5b6b7a;\">\r\n          If the ID on the image does not match the value above, reply to this email with the corrected ID so we can update our records immediately.\r\n        </p>\r\n\r\n        <p style=\"margin:0 0 6px 0;\">Thank you,</p>\r\n        <p style=\"margin:0;\">\r\n          <strong>Lena Papakonstantinou</strong><br>\r\n          Receptionist, EMB Management<br>\r\n          <span style=\"color:#5b6b7a;\">425-452-7330</span>  |  <a href=\"mailto:lpapakonstantinou@embmanagement.com\" style=\"color:#0b5cab; text-decoration:none;\">lpapakonstantinou@embmanagement.com</a>\r\n        </p>\r\n    `, v)\r\n  }\r\n};","import { templates } from \"./templates.js\";\r\nimport { selectedImage } from \"./taskpane.js\";\r\n\r\nexport function updatePreview() {\r\n  const templateKey = document.getElementById('templateSelect').value;\r\n  const template = templates[templateKey];\r\n  if (!template) return;\r\n\r\n  const values = {};\r\n  template.variables.forEach(v => {\r\n    if (v.type === 'file') {\r\n      // Use the imported selectedImage which is a live binding\r\n      values[v.name] = selectedImage || '';\r\n    } else {\r\n      values[v.name] = document.getElementById(v.name)?.value || `{{${v.name}}}`;\r\n    }\r\n  });\r\n\r\n  const emailBody = template.body(values);\r\n  const iframe = document.getElementById('previewFrame');\r\n  const container = iframe.parentElement;\r\n\r\n  // Set up the onload event for the iframe to run after content is rendered.\r\n  iframe.onload = () => {\r\n    const contentWidth = 650; // The fixed width of your email's main table\r\n    const containerWidth = container.clientWidth;\r\n    \r\n    // Get the body element inside the iframe\r\n    const iframeBody = iframe.contentDocument.body;\r\n\r\n    // --- NEW LOGIC ---\r\n    // Temporarily remove padding and background for a tight fit in the preview.\r\n    // This makes the main table the effective boundary for scaling.\r\n    iframeBody.style.padding = '0';\r\n    iframeBody.style.backgroundColor = 'transparent';\r\n    iframeBody.style.width = \"650px\"; // Match the email content width\r\n    // --- END NEW LOGIC ---\r\n\r\n    if (containerWidth < contentWidth) {\r\n      const scale = containerWidth / contentWidth;\r\n      \r\n      // Apply the scale transformation\r\n      iframeBody.style.transform = `scale(${scale})`;\r\n      iframeBody.style.transformOrigin = 'top left';\r\n      \r\n      // Adjust the iframe's height to match the scaled content\r\n      iframe.style.height = (iframeBody.scrollHeight * scale) + 'px';\r\n    } else {\r\n      // If the container is wide enough, reset transformations\r\n      iframeBody.style.transform = 'none';\r\n      iframe.style.height = iframeBody.scrollHeight + 'px';\r\n    }\r\n  };\r\n\r\n  // Write the new content to the iframe, which will trigger the onload event\r\n  iframe.contentDocument.open();\r\n  iframe.contentDocument.write(emailBody);\r\n  iframe.contentDocument.close();\r\n}","import { templates } from \"./templates.js\";\r\nimport { updatePreview } from \"./preview.js\";\r\n// Import the new setter function from taskpane.js\r\nimport { setSelectedImage } from \"./taskpane.js\";\r\n\r\nexport function renderFormFields(templateKey) {\r\n  const formFieldsDiv = document.getElementById('formFields');\r\n  const pasteButton = document.getElementById('pasteButton');\r\n  const livePreviewContainer = document.getElementById('livePreviewContainer');\r\n\r\n  // Ensure transition styles are set\r\n  [formFieldsDiv, pasteButton, livePreviewContainer].forEach(el => {\r\n    el.style.transition = 'opacity 0.5s ease';\r\n  });\r\n\r\n  // Fade out everything first\r\n  formFieldsDiv.style.opacity = 0;\r\n  pasteButton.style.opacity = 0;\r\n  livePreviewContainer.style.opacity = 0;\r\n\r\n  // After fade-out completes, clear and rebuild\r\n  setTimeout(() => {\r\n    formFieldsDiv.innerHTML = '';\r\n\r\n    const variables = templates[templateKey].variables;\r\n\r\n    // Reset parent container opacity so children can fade in\r\n    formFieldsDiv.style.opacity = 1;\r\n\r\n    variables.forEach((v, i) => {\r\n      const wrapper = document.createElement('div');\r\n\r\n      if (v.type === 'file') {\r\n        const imageUploadContainer = document.createElement('div');\r\n        imageUploadContainer.id = 'imageUploadContainer';\r\n        const imageUploadLabel = document.createElement('label');\r\n        imageUploadLabel.innerText = 'Key Fob Image';\r\n        imageUploadLabel.htmlFor = 'imageUpload';\r\n        const imageUpload = document.createElement('input');\r\n        imageUpload.type = 'file';\r\n        imageUpload.id = 'imageUpload';\r\n        imageUpload.accept = 'image/*';\r\n        \r\n        imageUpload.addEventListener('change', (event) => {\r\n          const file = event.target.files[0];\r\n          if (file) {\r\n            const reader = new FileReader();\r\n            reader.onload = (e) => {\r\n              const img = new Image();\r\n              img.onload = () => {\r\n                if (typeof cv === 'undefined') {\r\n                  console.error('OpenCV.js is not loaded.');\r\n                  return;\r\n                }\r\n\r\n                const mat = cv.imread(img);\r\n                const dst = new cv.Mat();\r\n                const dsize = new cv.Size(0, 0);\r\n                const maxDim = 600;\r\n                let width = mat.cols;\r\n                let height = mat.rows;\r\n\r\n                if (width > height) {\r\n                  height = Math.round(height * maxDim / width);\r\n                  width = maxDim;\r\n                } else {\r\n                  width = Math.round(width * maxDim / height);\r\n                  height = maxDim;\r\n                }\r\n\r\n                cv.resize(mat, dst, new cv.Size(width, height), 0, 0, cv.INTER_AREA);\r\n                const canvas = document.createElement('canvas');\r\n                cv.imshow(canvas, dst);\r\n                \r\n                // Use the setter function to update the shared variable\r\n                setSelectedImage(canvas.toDataURL('image/jpeg', 0.8));\r\n\r\n                mat.delete();\r\n                dst.delete();\r\n\r\n                updatePreview();\r\n              };\r\n              img.src = e.target.result;\r\n            };\r\n            reader.readAsDataURL(file);\r\n          }\r\n        });\r\n\r\n        imageUploadContainer.appendChild(imageUploadLabel);\r\n        imageUploadContainer.appendChild(imageUpload);\r\n        wrapper.appendChild(imageUploadContainer);\r\n      } else {\r\n        const label = document.createElement('label');\r\n        label.innerText = camelToTitle(v.name);\r\n        label.htmlFor = v.name;\r\n\r\n        const input = document.createElement('input');\r\n        input.type = v.type;\r\n        input.id = v.name;\r\n        input.placeholder = v.name;\r\n        input.addEventListener('input', updatePreview);\r\n        \r\n        wrapper.appendChild(label);\r\n        wrapper.appendChild(input);\r\n      }\r\n\r\n      // Initial fade style\r\n      wrapper.style.opacity = 0;\r\n      wrapper.style.transition = 'opacity 0.5s ease';\r\n\r\n      formFieldsDiv.appendChild(wrapper);\r\n\r\n      // Trigger fade-in staggered\r\n      setTimeout(() => {\r\n        wrapper.style.opacity = 1;\r\n      }, i * 150);\r\n    });\r\n\r\n    // After all fields start fading in, fade in pasteButton and livePreviewContainer\r\n    const totalDelay = variables.length * 150;\r\n\r\n    setTimeout(() => {\r\n      pasteButton.style.opacity = 1;\r\n\r\n      setTimeout(() => {\r\n        livePreviewContainer.style.opacity = 1;\r\n      }, 150);\r\n    }, totalDelay);\r\n\r\n  }, 500); // wait for fade-out duration before clearing\r\n}\r\n\r\nfunction camelToTitle(str) {\r\n  return str\r\n    .replace(/([A-Z])/g, \" $1\") // insert space before capital letters\r\n    .replace(/^./, (char) => char.toUpperCase()); // capitalize the first character\r\n}","import { templates } from \"./templates.js\";\r\n\r\nexport function pasteToOutlook(templateKey, selectedImage) {\r\n  const template = templates[templateKey];\r\n  if (!template) return;\r\n\r\n  const values = {};\r\n  template.variables.forEach(v => {\r\n    values[v.name] = document.getElementById(v.name)?.value || `{{${v}}}`;\r\n  });\r\n  values.documentName = template.documentName;\r\n  values.documentShortText = typeof template.documentShortText === \"function\" ? template.documentShortText(values) : template.documentShortText;\r\n  values.keyFobImage = selectedImage || '';\r\n\r\n  const emailBody = template.body(values);\r\n  const subject = template.subject(values);\r\n\r\n  const item = Office.context.mailbox.item;\r\n\r\n  try {\r\n  item.subject.getAsync((asyncResult) => {\r\n  if (asyncResult.status === Office.AsyncResultStatus.Succeeded) {\r\n    if (asyncResult.value.length === 0) {\r\n      item.subject.setAsync(subject);\r\n    }\r\n    console.log(\"Subject:\", asyncResult.value);\r\n  }\r\n});\r\n  } catch (error) {\r\n    console.error(\"Error accessing subject:\", error);\r\n  } \r\n\r\n  if (item.itemType === Office.MailboxEnums.ItemType.Message && typeof item.body.setSelectedDataAsync === \"function\") {\r\n    item.body.setSelectedDataAsync(emailBody, { coercionType: Office.CoercionType.Html });\r\n  } else {\r\n    Office.context.mailbox.item.displayReplyAllFormAsync({ htmlBody: emailBody });\r\n  }\r\n}","// taskpane.js\n\nimport { templates } from \"./templates.js\";\nimport { renderFormFields } from \"./form.js\";\nimport { updatePreview } from \"./preview.js\";\nimport { pasteToOutlook } from \"./outlook.js\";\n\nexport let selectedImage = null;\n\n// Create and export a \"setter\" function to modify the selectedImage variable\nexport function setSelectedImage(imageData) {\n  selectedImage = imageData;\n}\n\n// This function will initialize the add-in's main logic.\nfunction initializeAddIn() {\n  const templateSelect = document.getElementById('templateSelect');\n  document.getElementById(\"sideload-msg\").style.display = \"none\";\n\n  Object.keys(templates).forEach(key => {\n    const option = document.createElement('option');\n    option.value = key;\n    option.textContent = templates[key].name;\n    templateSelect.appendChild(option);\n  });\n\n  renderFormFields(templateSelect.value);\n  updatePreview();\n\n  templateSelect.addEventListener('change', () => {\n    renderFormFields(templateSelect.value);\n    updatePreview();\n  });\n\n  document.getElementById('pasteButton').addEventListener('click', async () => {\n    await pasteToOutlook(templateSelect.value, selectedImage);\n  });\n}\n\n// Ensure Office.js is ready before anything else runs.\nOffice.onReady(() => {\n    // Then, wait for the window to finish loading, which includes OpenCV.js.\n        initializeAddIn();\n});"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","baseTemplate","content","v","concat","documentName","documentShortText","templates","payment","name","subject","associationName","accountNumber","variables","type","body","ownerName","amountDue","orderingResaleDocs","recipientName","receipt","amountPaid","paymentDate","resale","propertyAddress","deadlineDate","welcome","moveInDate","keyFob","unitNumber","residentName","mailDate","keyFobId","keyFobImage","updatePreview","templateKey","document","getElementById","value","template","values","forEach","_document$getElementB","selectedImage","emailBody","iframe","container","parentElement","onload","containerWidth","clientWidth","iframeBody","contentDocument","style","padding","backgroundColor","width","scale","transform","transformOrigin","height","scrollHeight","open","write","close","renderFormFields","formFieldsDiv","pasteButton","livePreviewContainer","el","transition","opacity","setTimeout","innerHTML","i","wrapper","createElement","imageUploadContainer","id","imageUploadLabel","innerText","htmlFor","imageUpload","accept","addEventListener","event","file","target","files","reader","FileReader","e","img","Image","cv","mat","imread","dst","Mat","maxDim","Size","cols","rows","Math","round","resize","INTER_AREA","canvas","imshow","setSelectedImage","toDataURL","delete","console","error","src","result","readAsDataURL","appendChild","label","replace","char","toUpperCase","input","placeholder","totalDelay","length","pasteToOutlook","item","Office","context","mailbox","getAsync","asyncResult","status","AsyncResultStatus","Succeeded","setAsync","log","itemType","MailboxEnums","ItemType","Message","setSelectedDataAsync","coercionType","CoercionType","Html","displayReplyAllFormAsync","htmlBody","t","r","Symbol","n","iterator","toStringTag","c","Generator","u","create","_regeneratorDefine2","f","p","y","G","a","d","bind","l","TypeError","done","return","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","_invoke","configurable","writable","asyncGeneratorStep","Promise","resolve","then","_asyncToGenerator","arguments","apply","_next","_throw","imageData","onReady","templateSelect","display","keys","option","textContent","_callee","_context"],"sourceRoot":""}