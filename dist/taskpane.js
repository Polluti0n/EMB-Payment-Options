/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={d:function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}};!function(){function t(e,t){return'<!doctype html>\n<html lang="en">\n  <head>\n    <meta charset="utf-8">\n    <title>'.concat(t.documentName,'</title>\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <style type="text/css">\n      body {\n        margin: 0;\n        padding: 0;\n        background-color: #f4f6f8;\n      }\n\n      table {\n        border-collapse: collapse;\n        mso-table-lspace: 0pt;\n        mso-table-rspace: 0pt;\n      }\n\n      img {\n        border: 0;\n        line-height: 100%;\n        outline: none;\n        text-decoration: none;\n        display: block;\n      }\n\n      a img {\n        border: 0;\n      }\n\n      .apple-link a {\n        color: inherit !important;\n        text-decoration: none !important;\n        font-family: inherit !important;\n        font-size: inherit !important;\n        font-weight: inherit !important;\n        line-height: inherit !important;\n      }\n\n      @media only screen and (max-width: 620px) {\n        .wrapper {\n          width: 100% !important;\n        }\n\n        .content {\n          padding: 20px !important;\n        }\n\n        .stack {\n          display: block !important;\n          width: 100% !important;\n        }\n\n        .center {\n          text-align: center !important;\n        }\n\n        .mobile-left {\n          text-align: left !important;\n        }\n      }\n    </style>\n    </head>\n  <body style="margin: 0; padding: 24px 0; background-color: #f4f6f8;">\n    <div style="display: none; max-height: 0; overflow: hidden; font-size: 1px; line-height: 1px; color: #f4f6f8;">\n      ').concat(t.documentShortText||"",'\n    </div>\n    <table role="presentation" class="wrapper" width="650" cellpadding="0" cellspacing="0" border="0" align="center" style="width: 650px; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.06);">\n      <tr>\n        <td style="background-color: #0c233f; padding: 18px 24px;">\n          <table role="presentation" width="100%" cellpadding="0" cellspacing="0">\n            <tr>\n              <td class="center mobile-left" style="color: #ffffff; font: 700 18px/1.2 Arial, Helvetica, sans-serif; padding-bottom: 0px;" align="left" valign="middle">\n                <img src="https://i.imgur.com/4Bfswoj.png" alt="EMB Management" height="40" style="display: block; border: 0; max-width: 180px; height: auto;">\n              </td>\n              <td align="right" valign="middle" class="stack" style="color: #cfe3fb; font: 400 12px/1.4 Arial, Helvetica, sans-serif;">\n                ').concat(t.documentName||"",'\n              </td>\n            </tr>\n          </table>\n        </td>\n      </tr>\n      <tr>\n        <td class="content" style="padding: 30px 40px; color: #333333; font-size: 15px; line-height: 1.6; font-family: Arial, sans-serif;">\n          ').concat(e,'\n        </td>\n      </tr>\n    </table>\n    <table role="presentation" width="100%" cellpadding="0" cellspacing="0" border="0">\n      <tr>\n        <td align="center" style="padding: 24px 0 0 0;">\n          <table role="presentation" class="wrapper" width="650" cellpadding="0" cellspacing="0" border="0" align="center" style="width: 650px;">\n            <tr>\n              <td style="font-size: 12px; color: #777777; padding: 10px 40px; text-align: center;">\n                <hr style="border: none; border-top: 1px solid #e6edf5; margin: 0 0 12px 0;">\n                <p style="margin: 0;">This email may contain confidential information intended only for the recipient. If you are not the intended recipient, please delete this message.</p>\n              </td>\n            </tr>\n          </table>\n        </td>\n      </tr>\n    </table>\n  </body>\n</html>')}e.d({},{F:function(){return ge}});var n,o={payment:{name:"Payment Options",subject:function(e){return"Payment Option Information for ".concat(e.associationName)},documentName:"Payment Option Information",documentShortText:function(e){return"Payment option information for ".concat(e.associationName,", account ").concat(e.accountNumber)},variables:[{name:"propertyName",type:"text"},{name:"ownerName",type:"text"},{name:"associationName",type:"text"},{name:"accountNumber",type:"text"},{name:"amountDue",type:"text"}],body:function(e){return t("\n        <h2>Account Balance Information</h2>\n        <p>Dear ".concat(e.ownerName,",</p>\n        <p>Below are the payment options available for <strong>").concat(e.associationName,"</strong>. Please be sure to reference your account number <strong>").concat(e.accountNumber,'</strong> with all payments.</p>\n\n        <div class="amount-due">\n          Current Amount Due: $').concat(e.amountDue,'\n        </div>\n\n        <div class="section-divider"></div>\n        <h2><img src="https://img.icons8.com/?size=24&id=18635&format=png&color=000000" alt="Mail" class="icon"/> Mailing Payments</h2>\n        <p>Please ensure checks are made payable to <strong>').concat(e.associationName,'</strong>. Be sure to include your account number on the memo/notes line. Any payment received without an account number may be returned as “Unable to Locate Account.”</p>\n        <p>Mail payments to:</p>\n        <div style="border:1px solid #0c233f; padding:10px 20px; display:inline-block; margin:10px 0;">\n          ').concat(e.associationName,'<br>c/o EMB Management<br>PO Box 45450<br>San Francisco, CA 94145-0450\n        </div>\n\n        <div class="section-divider"></div>\n        <h2><img src="https://img.icons8.com/?size=24&id=6Rw34qscHREa&format=png&color=000000" alt="ACH" class="icon"/> Automatic Debit (ACH/DD)</h2>\n        <p>With ACH, your monthly assessment is automatically drafted from your bank account between the 5th–10th each month. This option is <strong>free of charge</strong> and ensures you never miss a payment or risk late fees.</p>\n        <p><a href="https://drive.google.com/file/d/1oEAdpHZpMgn_Dfh2cCc43qALZQsX5o8W/view?usp=sharing" class="button" target="_blank">Download ACH Form</a></p>\n        <p>Please complete the form and return it with a voided check. For activation by next month’s assessment, it must be received by the 20th of the current month. ACH will only pull the current monthly assessment amount due. If your account has a balance beyond the monthly assessment, you must make a one-time payment using another option.</p>\n\n        <div class="section-divider"></div>\n        <h2><img src="https://img.icons8.com/?size=24&id=VbL8v3mm1qyp&format=png&color=000000" alt="Bill Pay" class="icon"/> Bill Pay</h2>\n        <p>Bill Pay can be set up through your financial institution or online at <a href="https://app.townsq.io/login">TownSq.io</a>. Please allow 5–7 business days for processing. Make checks payable to <strong>').concat(e.associationName,'</strong>, and include your last name/unit number (if applicable) and your account number on the memo line.</p>\n        <p>Mail to the same address listed above.</p>\n\n        <div class="section-divider"></div>\n        <h2><img src="https://cdn.prod.website-files.com/67c157877f705a5a2a3dcb3c/682b757bf89cef02a37a43d9_TSQ%20Icon_Webclip.png" style="width:18px;padding:4px;" alt="Online" class="icon"/> Online Payments (TownSq)</h2>\n        <p>One-time or recurring payments may be made through <a href="https://app.townsq.io/registration/account-number">TownSq.io</a> using a credit/debit card or checking/savings account. Registration is free.</p>\n        <p><strong>How to Register:</strong></p>\n        <ul>\n          <li style="line-height: 1;">Click “Need to Register” on the login page</li>\n          <li style="line-height: 1;">Enter the property’s zip code</li>\n          <li style="line-height: 1;">Enter your account number (').concat(e.accountNumber,') — no dashes or leading zeros</li>\n          <li style="line-height: 1;">Review the terms of service and click "Next".</li>\n          <li style="line-height: 1;">Verify your acount details are correct and click "Next".</li>\n          <li style="line-height: 1;">Finally, create a password for your account to finish registration.</li>\n        </ul>\n        <p><strong>TownSq Fees:</strong></p>\n        <ul>\n          <li style="line-height: 1;">Bank Account (ACH): $2.95 per transaction</li>\n          <li style="line-height: 1;">Credit/Debit Card: $2.95 + 3.5% of total</li>\n        </ul>\n        <p>Note: When using a bank account, the 3.5% fee will appear but then show a “cash discount” credit. The 3.5% will be waived in the final total. These fees are charged by TownSq (a third-party processor) and do not go to EMB Management. Using TownSq also ensures your payment information is processed securely.</p>\n\n        <div class="section-divider"></div>\n        <h2>Need Assistance?</h2>\n        <p>We’re here to help. Contact EMB Management at <a href="tel:4254527330">(425) 452-7330</a> or reply to this email with any questions.</p>\n\n        <p>Thank you,<br><br>\n        <strong>EMB Management Team</strong><br>\n        <a href="https://www.google.com/maps/dir/?api=1&destination=Associa%20EMB%20Management">\n        15301 NE 90th Street, Suite Q-170<br>\n        Redmond, WA 98052</a>'),e)}},receipt:{name:"Confirmed Receipt",subject:function(e){return"Payment Receipt Confirmation for ".concat(e.associationName)},documentName:"Payment Receipt",documentShortText:function(e){return"Receipt of $".concat(e.amountPaid," from ").concat(e.ownerName," for ").concat(e.associationName)},variables:[{name:"propertyName",type:"text"},{name:"ownerName",type:"text"},{name:"associationName",type:"text"},{name:"amountPaid",type:"text"},{name:"paymentDate",type:"date"}],body:function(e){return t("\n      <h2>Payment Confirmation</h2>\n      <p>Dear ".concat(e.ownerName,",</p>\n      <p>This is to confirm we received your payment of <strong>$").concat(e.amountPaid,"</strong> \n      for <strong>").concat(e.associationName,"</strong> on <strong>").concat(e.paymentDate,"</strong>.</p>\n      <p>Thank you for your timely payment.</p>\n    "),e)}},resale:{name:"Resale Document Signature",subject:function(e){return"Resale Document Signature Request for ".concat(e.associationName)},documentName:"Resale Document Request",documentShortText:function(e){return"Signature request for ".concat(e.ownerName," at ").concat(e.propertyAddress)},variables:[{name:"propertyName",type:"text"},{name:"ownerName",type:"text"},{name:"associationName",type:"text"},{name:"propertyAddress",type:"text"},{name:"deadlineDate",type:"date"}],body:function(e){return t("\n      <h2>Resale Document Signature Required</h2>\n      <p>Dear ".concat(e.ownerName,",</p>\n      <p>To proceed with the sale of <strong>").concat(e.propertyAddress,"</strong> in \n      <strong>").concat(e.associationName,"</strong>, please review and sign the attached resale documents by \n      <strong>").concat(e.deadlineDate,"</strong>.</p>\n      <p>If you have questions, contact our office immediately.</p>\n    "),e)}},welcome:{name:"Welcome Packet",subject:function(e){return"Welcome to ".concat(e.associationName,"!")},documentName:"Welcome Packet",documentShortText:function(e){return"Welcome letter for ".concat(e.ownerName," moving into ").concat(e.associationName)},variables:[{name:"propertyName",type:"text"},{name:"ownerName",type:"text"},{name:"associationName",type:"text"},{name:"moveInDate",type:"date"}],body:function(e){return t("\n      <h2>Welcome to ".concat(e.associationName,"</h2>\n      <p>Dear ").concat(e.ownerName,",</p>\n      <p>Welcome! We’re excited to have you as part of our community starting <strong>").concat(e.moveInDate,"</strong>.</p>\n      <p>Your welcome packet is attached, which contains important information about community rules, amenities, and contacts.</p>\n    "),e)}},keyFob:{name:"Key Fob Mailing",subject:function(e){return"Key Fob Mailing Confirmation for ".concat(e.associationName," Unit ").concat(e.unitNumber)},documentName:"Key Fob Mailing Confirmation",documentShortText:function(e){return"Confirmation that a new key fob has been mailed to ".concat(e.residentName," at ").concat(e.associationName," Unit ").concat(e.unitNumber," on ").concat(e.mailDate)},variables:[{name:"associationName",type:"text"},{name:"unitNumber",type:"text"},{name:"mailDate",type:"date"},{name:"residentName",type:"text"},{name:"keyFobId",type:"text"},{name:"keyFobImage",type:"file"}],body:function(e){return t('\n        <p style="margin:0 0 14px 0;">Hello Board Members,</p>\n\n        <p style="margin:0 0 14px 0;">\n          This is a confirmation that a new key fob has been mailed to a resident at\n          <strong>'.concat(e.associationName,"</strong>, unit <strong>").concat(e.unitNumber,"</strong>, on <strong>").concat(e.mailDate,'</strong>.\n        </p>\n\n        <table role="presentation" cellpadding="0" cellspacing="0" width="100%" style="margin:16px 0; background:#f8fafc; border:1px solid #e6edf5; border-radius:10px;">\n          <tr>\n            <td style="padding:16px 18px;">\n              <table role="presentation" width="100%" cellpadding="0" cellspacing="0">\n                <tr>\n                  <td class="stack" style="vertical-align:top; width:60%;">\n                    <p style="margin:0 0 8px 0; font:700 14px Arial, Helvetica, sans-serif; color:#0b5cab;">\n                      Fulfillment Details\n                    </p>\n                    <p style="margin:0; font:400 14px Arial, Helvetica, sans-serif;">\n                      Resident, <strong>').concat(e.residentName,"</strong><br>\n                      Unit, <strong>").concat(e.unitNumber,'</strong><br>\n                      Key Fob ID, <strong style="letter-spacing:0.5px;">').concat(e.keyFobId,"</strong><br>\n                      Mail date, <strong>").concat(e.mailDate,'</strong>\n                    </p>\n                  </td>\n                  <td class="stack" style="vertical-align:top; width:40%; text-align:right;">\n                    <img src="').concat(e.keyFobImage,'"\n                         width="220"\n                         alt="Back of key fob showing ID ').concat(e.keyFobId,'"\n                         style="max-width:220px; height:auto; border-radius:8px; border:1px solid #e6edf5; display:inline-block;">\n                    <div style="font:12px Arial, Helvetica, sans-serif; color:#5b6b7a; margin-top:6px;">\n                      Image, back of key fob for verification\n                    </div>\n                  </td>\n                </tr>\n              </table>\n            </td>\n          </tr>\n        </table>\n\n        <p style="margin:0 0 12px 0;">\n          Action requested, please activate the key fob with ID <strong>').concat(e.keyFobId,"</strong> for unit <strong>").concat(e.unitNumber,'</strong>.\n        </p>\n\n        <p style="margin:0 0 18px 0; color:#5b6b7a;">\n          If the ID on the image does not match the value above, reply to this email with the corrected ID so we can update our records immediately.\n        </p>\n\n        <p style="margin:0 0 6px 0;">Thank you,</p>\n        <p style="margin:0;">\n          <strong>Lena Papakonstantinou</strong><br>\n          Receptionist, EMB Management<br>\n          <span style="color:#5b6b7a;">425-452-7330</span>  |  <a href="mailto:lpapakonstantinou@embmanagement.com" style="color:#0b5cab; text-decoration:none;">lpapakonstantinou@embmanagement.com</a>\n        </p>\n      </td>\n    </tr>\n\n    <tr>\n      <td style="padding:18px 28px 28px 28px; font:12px Arial, Helvetica, sans-serif; color:#6b7a89;">\n        <hr style="border:none; border-top:1px solid #e6edf5; margin:0 0 12px 0;">\n        <p style="margin:0;">\n          This message is intended for the board of <strong>').concat(e.associationName,"</strong>. If you received it in error, please let us know, then delete it.\n        </p>\n    "),e)}}};function r(){var e=document.getElementById("templateSelect").value,t=o[e];if(t){var n={};t.variables.forEach(function(e){var t;"file"===e.type?n[e.name]=ge||"":n[e.name]=(null===(t=document.getElementById(e.name))||void 0===t?void 0:t.value)||"{{".concat(e.name,"}}")});var r=t.body(n),i=document.getElementById("previewFrame");i.contentDocument.open(),i.contentDocument.write(r),i.contentDocument.close()}}function i(e){var t=document.getElementById("formFields"),n=document.getElementById("pasteButton"),i=document.getElementById("livePreviewContainer"),a=document.getElementById("imageUploadContainer");a.style.display="none",[t,n,i].forEach(function(e){e.style.transition="opacity 0.5s ease"}),t.style.opacity=0,n.style.opacity=0,i.style.opacity=0,setTimeout(function(){t.innerHTML="";var s=o[e].variables;t.style.opacity=1,s.forEach(function(e,n){if("file"!==e.type){var o=document.createElement("label");o.innerText=e.name.replace(/([A-Z])/g," $1").replace(/^./,function(e){return e.toUpperCase()}),o.htmlFor=e.name;var i=document.createElement("input");i.type=e.type,i.id=e.name,i.placeholder=e.name,i.addEventListener("input",r);var a=document.createElement("div");a.appendChild(o),a.appendChild(i),a.style.opacity=0,a.style.transition="opacity 0.5s ease",t.appendChild(a),setTimeout(function(){a.style.opacity=1},150*n)}}),a.style.display="keyFob"===e?"block":"none";var c=150*s.length;setTimeout(function(){n.style.opacity=1,setTimeout(function(){i.style.opacity=1},150)},c)},500)}function a(e,t,n,o){return new(n||(n=Promise))(function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(a,s)}c((o=o.apply(e,t||[])).next())})}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError,function(e){e.GET="GET",e.PATCH="PATCH",e.POST="POST",e.PUT="PUT",e.DELETE="DELETE"}(n||(n={}));class s{static validateDependencies(e){if(0===e.size){const e=new Error("Empty requests map, Please provide at least one request.");throw e.name="Empty Requests Error",e}return(e=>{const t=e.entries();let n=t.next();for(;!n.done;){const e=n.value[1];if(void 0!==e.dependsOn&&e.dependsOn.length>0)return!1;n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const o=n.value[1];if(void 0!==o.dependsOn&&o.dependsOn.length>0)return!1;let r=n;for(n=t.next();!n.done;){const e=n.value[1];if(void 0===e.dependsOn||1!==e.dependsOn.length||e.dependsOn[0]!==r.value[1].id)return!1;r=n,n=t.next()}return!0})(e)||(e=>{const t=e.entries();let n=t.next();const o=n.value[1];let r;if(void 0===o.dependsOn||0===o.dependsOn.length)r=o.id;else{if(1!==o.dependsOn.length)return!1;{const t=o.dependsOn[0];if(t===o.id||!e.has(t))return!1;r=t}}for(n=t.next();!n.done;){const e=n.value[1];if((void 0===e.dependsOn||0===e.dependsOn.length)&&r!==e.id)return!1;if(void 0!==e.dependsOn&&0!==e.dependsOn.length){if(1===e.dependsOn.length&&(e.id===r||e.dependsOn[0]!==r))return!1;if(e.dependsOn.length>1)return!1}n=t.next()}return!0})(e)}static getRequestData(e){return a(this,void 0,void 0,function*(){const t={url:""},o=new RegExp("^https?://");t.url=o.test(e.url)?"/"+e.url.split(/.*?\/\/.*?\//)[1]:e.url,t.method=e.method;const r={};return e.headers.forEach((e,t)=>{r[t]=e}),Object.keys(r).length&&(t.headers=r),e.method!==n.PATCH&&e.method!==n.POST&&e.method!==n.PUT||(t.body=yield s.getRequestBody(e)),t})}static getRequestBody(e){return a(this,void 0,void 0,function*(){let t,n=!1;try{const o=e.clone();t=yield o.json(),n=!0}catch(e){}if(!n)try{if("undefined"!=typeof Blob){const n=yield e.blob(),o=new FileReader;t=yield new Promise(e=>{o.addEventListener("load",()=>{const t=o.result,n=new RegExp("^s*data:(.+?/.+?(;.+?=.+?)*)?(;base64)?,(.*)s*$").exec(t);e(n[4])},!1),o.readAsDataURL(n)})}else"undefined"!=typeof Buffer&&(t=(yield e.buffer()).toString("base64"));n=!0}catch(e){}return t})}constructor(e){if(this.requests=new Map,void 0!==e){const t=s.requestLimit;if(e.length>t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}for(const t of e)this.addRequest(t)}}addRequest(e){const t=s.requestLimit;if(""===e.id){const e=new Error("Id for a request is empty, Please provide an unique id");throw e.name="Empty Id For Request",e}if(this.requests.size===t){const e=new Error(`Maximum requests limit exceeded, Max allowed number of requests are ${t}`);throw e.name="Limit Exceeded Error",e}if(this.requests.has(e.id)){const t=new Error(`Adding request with duplicate id ${e.id}, Make the id of the requests unique`);throw t.name="Duplicate RequestId Error",t}return this.requests.set(e.id,e),e.id}removeRequest(e){const t=this.requests.delete(e),n=this.requests.entries();let o=n.next();for(;!o.done;){const t=o.value[1].dependsOn;if(void 0!==t){const n=t.indexOf(e);-1!==n&&t.splice(n,1),0===t.length&&delete o.value[1].dependsOn}o=n.next()}return t}getContent(){return a(this,void 0,void 0,function*(){const e=[],t={requests:e},n=this.requests.entries();let o=n.next();if(o.done){const e=new Error("No requests added yet, Please add at least one request.");throw e.name="Empty Payload",e}if(!s.validateDependencies(this.requests)){const e=new Error("Invalid dependency found, Dependency should be:\n1. Parallel - no individual request states a dependency in the dependsOn property.\n2. Serial - all individual requests depend on the previous individual request.\n3. Same - all individual requests that state a dependency in the dependsOn property, state the same dependency.");throw e.name="Invalid Dependency",e}for(;!o.done;){const t=o.value[1],r=yield s.getRequestData(t.request);if(void 0!==r.body&&(void 0===r.headers||void 0===r.headers["content-type"])){const e=new Error(`Content-type header is not mentioned for request #${t.id}, For request having body, Content-type header should be mentioned`);throw e.name="Invalid Content-type header",e}r.id=t.id,void 0!==t.dependsOn&&t.dependsOn.length>0&&(r.dependsOn=t.dependsOn),e.push(r),o=n.next()}return t.requests=e,t})}addDependency(e,t){if(!this.requests.has(e)){const t=new Error(`Dependent ${e} does not exists, Please check the id`);throw t.name="Invalid Dependent",t}if(void 0!==t&&!this.requests.has(t)){const e=new Error(`Dependency ${t} does not exists, Please check the id`);throw e.name="Invalid Dependency",e}if(void 0!==t){const n=this.requests.get(e);if(void 0===n.dependsOn&&(n.dependsOn=[]),-1!==n.dependsOn.indexOf(t)){const n=new Error(`Dependency ${t} is already added for the request ${e}`);throw n.name="Duplicate Dependency",n}n.dependsOn.push(t)}else{const n=this.requests.entries();let o,r=n.next();for(;!r.done&&r.value[1].id!==e;)o=r,r=n.next();if(void 0===o){const e=new Error(`Can't add dependency ${t}, There is only a dependent request in the batch`);throw e.name="Invalid Dependency Addition",e}{const t=o.value[0];if(void 0===r.value[1].dependsOn&&(r.value[1].dependsOn=[]),-1!==r.value[1].dependsOn.indexOf(t)){const n=new Error(`Dependency ${t} is already added for the request ${e}`);throw n.name="Duplicate Dependency",n}r.value[1].dependsOn.push(t)}}}removeDependency(e,t){const n=this.requests.get(e);if(void 0===n||void 0===n.dependsOn||0===n.dependsOn.length)return!1;if(void 0!==t){const e=n.dependsOn.indexOf(t);return-1!==e&&(n.dependsOn.splice(e,1),!0)}return delete n.dependsOn,!0}}s.requestLimit=20;const c=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class d extends Error{static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new d,t.customError=e),t}constructor(e){super(e),Object.setPrototypeOf(this,d.prototype)}}const l=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],u=e=>{const t=e&&e.constructor&&e.constructor.name;if("Buffer"===t||"Blob"===t||"File"===t||"FormData"===t||"string"==typeof e)return e;if("ArrayBuffer"===t)e=Buffer.from(e);else if("Int8Array"===t||"Int16Array"===t||"Int32Array"===t||"Uint8Array"===t||"Uint16Array"===t||"Uint32Array"===t||"Uint8ClampedArray"===t||"Float32Array"===t||"Float64Array"===t||"DataView"===t)e=Buffer.from(e.buffer);else try{e=JSON.stringify(e)}catch(e){throw new Error("Unable to stringify the content")}return e},p=e=>f(e),h=(e,t)=>(t.forEach(e=>m(e)),f(e,t)),f=(e,t=c)=>{if(-1!==(e=e.toLowerCase()).indexOf("https://")){const n=(e=e.replace("https://","")).indexOf(":"),o=e.indexOf("/");let r="";if(-1!==o)return-1!==n&&n<o?(r=e.substring(0,n),t.has(r)):(r=e.substring(0,o),t.has(r))}return!1},m=e=>{if(-1!==e.indexOf("/"))throw new d("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class y{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const e=t.constructor;this.middlewareOptions.set(e,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const g=(e,t,n)=>{let o=null;if("undefined"!=typeof Request&&e instanceof Request)o=e.headers.get(n);else if(void 0!==t&&void 0!==t.headers)if("undefined"!=typeof Headers&&t.headers instanceof Headers)o=t.headers.get(n);else if(t.headers instanceof Array){const e=t.headers;for(let t=0,r=e.length;t<r;t++)if(e[t][0]===n){o=e[t][1];break}}else void 0!==t.headers[n]&&(o=t.headers[n]);return o},v=(e,t,n,o)=>{if("undefined"!=typeof Request&&e instanceof Request)e.headers.set(n,o);else if(void 0!==t)if(void 0===t.headers)t.headers=new Headers({[n]:o});else if("undefined"!=typeof Headers&&t.headers instanceof Headers)t.headers.set(n,o);else if(t.headers instanceof Array){let e=0;const r=t.headers.length;for(;e<r;e++){const r=t.headers[e];if(r[0]===n){r[1]=o;break}}e===r&&t.headers.push([n,o])}else Object.assign(t.headers,{[n]:o})},b=(e,t,n,o)=>{"undefined"!=typeof Request&&e instanceof Request?e.headers.append(n,o):void 0!==t&&(void 0===t.headers?t.headers=new Headers({[n]:o}):"undefined"!=typeof Headers&&t.headers instanceof Headers?t.headers.append(n,o):t.headers instanceof Array?t.headers.push([n,o]):void 0===t.headers?t.headers={[n]:o}:void 0===t.headers[n]?t.headers[n]=o:t.headers[n]+=`, ${o}`)};class w{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var E,x,R,T,A,O,D;!function(e){e[e.NONE=0]="NONE",e[e.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",e[e.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",e[e.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"}(E||(E={}));class P{constructor(){this.featureUsage=E.NONE}static updateFeatureUsageFlag(e,t){let n;e.middlewareControl instanceof y?n=e.middlewareControl.getMiddlewareOptions(P):e.middlewareControl=new y,void 0===n&&(n=new P,e.middlewareControl.setMiddlewareOptions(P,n)),n.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class S{constructor(e){this.authenticationProvider=e}execute(e){return a(this,void 0,void 0,function*(){const t="string"==typeof e.request?e.request:e.request.url;if(p(t)||e.customHosts&&h(t,e.customHosts)){let t,n,o;e.middlewareControl instanceof y&&(t=e.middlewareControl.getMiddlewareOptions(w)),t&&(n=t.authenticationProvider,o=t.authenticationProviderOptions),n||(n=this.authenticationProvider);const r=`Bearer ${yield n.getAccessToken(o)}`;b(e.request,e.options,S.AUTHORIZATION_HEADER,r),P.updateFeatureUsageFlag(e,E.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[S.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}S.AUTHORIZATION_HEADER="Authorization";class N{constructor(e=N.DEFAULT_DELAY,t=N.DEFAULT_MAX_RETRIES,n=N.defaultShouldRetry){if(e>N.MAX_DELAY&&t>N.MAX_MAX_RETRIES){const e=new Error(`Delay and MaxRetries should not be more than ${N.MAX_DELAY} and ${N.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e>N.MAX_DELAY){const e=new Error(`Delay should not be more than ${N.MAX_DELAY}`);throw e.name="MaxLimitExceeded",e}if(t>N.MAX_MAX_RETRIES){const e=new Error(`MaxRetries should not be more than ${N.MAX_MAX_RETRIES}`);throw e.name="MaxLimitExceeded",e}if(e<0&&t<0){const e=new Error("Delay and MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}if(e<0){const e=new Error("Delay should not be negative");throw e.name="MinExpectationNotMet",e}if(t<0){const e=new Error("MaxRetries should not be negative");throw e.name="MinExpectationNotMet",e}this.delay=Math.min(e,N.MAX_DELAY),this.maxRetries=Math.min(t,N.MAX_MAX_RETRIES),this.shouldRetry=n}getMaxDelay(){return N.MAX_DELAY}}N.DEFAULT_DELAY=3,N.DEFAULT_MAX_RETRIES=3,N.MAX_DELAY=180,N.MAX_MAX_RETRIES=10,N.defaultShouldRetry=()=>!0;class C{constructor(e=new N){this.options=e}isRetry(e){return-1!==C.RETRY_STATUS_CODES.indexOf(e.status)}isBuffered(e,t){const o="string"==typeof e?t.method:e.method;return o!==n.PUT&&o!==n.PATCH&&o!==n.POST||"application/octet-stream"!==g(e,t,"Content-Type")}getDelay(e,t,n){const o=()=>Number(Math.random().toFixed(3)),r=void 0!==e.headers?e.headers.get(C.RETRY_AFTER_HEADER):null;let i;return i=null!==r?Number.isNaN(Number(r))?Math.round((new Date(r).getTime()-Date.now())/1e3):Number(r):t>=2?this.getExponentialBackOffTime(t)+n+o():n+o(),Math.min(i,this.options.getMaxDelay()+o())}getExponentialBackOffTime(e){return Math.round(.5*(Math.pow(2,e)-1))}sleep(e){return a(this,void 0,void 0,function*(){const t=1e3*e;return new Promise(e=>setTimeout(e,t))})}getOptions(e){let t;return e.middlewareControl instanceof y&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),void 0===t&&(t=Object.assign(new N,this.options)),t}executeWithRetry(e,t,n){return a(this,void 0,void 0,function*(){if(yield this.nextMiddleware.execute(e),t<n.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&n.shouldRetry(n.delay,t,e.request,e.options,e.response)){++t,v(e.request,e.options,C.RETRY_ATTEMPT_HEADER,t.toString());const o=this.getDelay(e.response,t,n.delay);return yield this.sleep(o),yield this.executeWithRetry(e,t,n)}})}execute(e){return a(this,void 0,void 0,function*(){const t=this.getOptions(e);return P.updateFeatureUsageFlag(e,E.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,t)})}setNext(e){this.nextMiddleware=e}}C.RETRY_STATUS_CODES=[429,503,504],C.RETRY_ATTEMPT_HEADER="Retry-Attempt",C.RETRY_AFTER_HEADER="Retry-After";class _{constructor(e=_.DEFAULT_MAX_REDIRECTS,t=_.defaultShouldRedirect){if(e>_.MAX_MAX_REDIRECTS){const e=new Error(`MaxRedirects should not be more than ${_.MAX_MAX_REDIRECTS}`);throw e.name="MaxLimitExceeded",e}if(e<0){const e=new Error("MaxRedirects should not be negative");throw e.name="MinExpectationNotMet",e}this.maxRedirects=e,this.shouldRedirect=t}}_.DEFAULT_MAX_REDIRECTS=5,_.MAX_MAX_REDIRECTS=20,_.defaultShouldRedirect=()=>!0;class M{constructor(e=new _){this.options=e}isRedirect(e){return-1!==M.REDIRECT_STATUS_CODES.indexOf(e.status)}hasLocationHeader(e){return e.headers.has(M.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(M.LOCATION_HEADER)}isRelativeURL(e){return-1===e.indexOf("://")}shouldDropAuthorizationHeader(e,t){const n=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,o=n.exec(e);let r,i;null!==o&&(r=o[0]);const a=n.exec(t);return null!==a&&(i=a[0]),void 0!==r&&void 0!==i&&r!==i}updateRequestUrl(e,t){return a(this,void 0,void 0,function*(){var n,o;t.request="string"==typeof t.request?e:yield(n=e,o=t.request,a(void 0,void 0,void 0,function*(){const e=o.headers.get("Content-Type")?yield o.blob():yield Promise.resolve(void 0),{method:t,headers:r,referrer:i,referrerPolicy:a,mode:s,credentials:c,cache:d,redirect:l,integrity:u,keepalive:p,signal:h}=o;return new Request(n,{method:t,headers:r,body:e,referrer:i,referrerPolicy:a,mode:s,credentials:c,cache:d,redirect:l,integrity:u,keepalive:p,signal:h})}))})}getOptions(e){let t;return e.middlewareControl instanceof y&&(t=e.middlewareControl.getMiddlewareOptions(_)),void 0===t&&(t=Object.assign(new _,this.options)),t}executeWithRedirect(e,t,o){return a(this,void 0,void 0,function*(){yield this.nextMiddleware.execute(e);const r=e.response;if(t<o.maxRedirects&&this.isRedirect(r)&&this.hasLocationHeader(r)&&o.shouldRedirect(r)){if(++t,r.status===M.STATUS_CODE_SEE_OTHER)e.options.method=n.GET,delete e.options.body;else{const t=this.getLocationHeader(r);!this.isRelativeURL(t)&&this.shouldDropAuthorizationHeader(r.url,t)&&delete e.options.headers[M.AUTHORIZATION_HEADER],yield this.updateRequestUrl(t,e)}yield this.executeWithRedirect(e,t,o)}})}execute(e){return a(this,void 0,void 0,function*(){const t=this.getOptions(e);return e.options.redirect=M.MANUAL_REDIRECT,P.updateFeatureUsageFlag(e,E.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,t)})}setNext(e){this.nextMiddleware=e}}M.REDIRECT_STATUS_CODES=[301,302,303,307,308],M.STATUS_CODE_SEE_OTHER=303,M.LOCATION_HEADER="Location",M.AUTHORIZATION_HEADER="Authorization",M.MANUAL_REDIRECT="manual";class I{execute(e){return a(this,void 0,void 0,function*(){const t="string"==typeof e.request?e.request:e.request.url;if(p(t)||e.customHosts&&h(t,e.customHosts)){let t=g(e.request,e.options,I.CLIENT_REQUEST_ID_HEADER);t||(t=(()=>{let e="";for(let t=0;t<32;t++)8!==t&&12!==t&&16!==t&&20!==t||(e+="-"),e+=Math.floor(16*Math.random()).toString(16);return e})(),v(e.request,e.options,I.CLIENT_REQUEST_ID_HEADER,t));let n,o=`${I.PRODUCT_NAME}/3.0.7`;if(e.middlewareControl instanceof y&&(n=e.middlewareControl.getMiddlewareOptions(P)),n){const e=n.getFeatureUsage();o+=` (${I.FEATURE_USAGE_STRING}=${e})`}b(e.request,e.options,I.SDK_VERSION_HEADER,o)}else delete e.options.headers[I.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[I.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}I.CLIENT_REQUEST_ID_HEADER="client-request-id",I.SDK_VERSION_HEADER="SdkVersion",I.PRODUCT_NAME="graph-js",I.FEATURE_USAGE_STRING="featureUsage",(R=x||(x={}))[R.MANUAL=0]="MANUAL",R[R.RANDOM=1]="RANDOM",function(e){e.ARRAYBUFFER="arraybuffer",e.BLOB="blob",e.DOCUMENT="document",e.JSON="json",e.RAW="raw",e.STREAM="stream",e.TEXT="text"}(T||(T={})),function(e){e.TEXT_HTML="text/html",e.TEXT_XML="text/xml",e.APPLICATION_XML="application/xml",e.APPLICATION_XHTML="application/xhtml+xml"}(A||(A={})),function(e){e.TEXT_PLAIN="text/plain",e.APPLICATION_JSON="application/json"}(O||(O={})),function(e){e.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",e.IMAGE="^image\\/.+"}(D||(D={}));class U{static parseDocumentResponse(e,t){return"undefined"!=typeof DOMParser?new Promise((n,o)=>{e.text().then(e=>{try{const o=(new DOMParser).parseFromString(e,t);n(o)}catch(e){o(e)}})}):Promise.resolve(e.body)}static convertResponse(e,t){return a(this,void 0,void 0,function*(){if(204===e.status)return Promise.resolve();let n;const o=e.headers.get("Content-type");switch(t){case T.ARRAYBUFFER:n=yield e.arrayBuffer();break;case T.BLOB:n=yield e.blob();break;case T.DOCUMENT:n=yield U.parseDocumentResponse(e,A.TEXT_XML);break;case T.JSON:n=yield e.json();break;case T.STREAM:n=yield Promise.resolve(e.body);break;case T.TEXT:n=yield e.text();break;default:if(null!==o){const t=o.split(";")[0];n=new RegExp(D.DOCUMENT).test(t)?yield U.parseDocumentResponse(e,t):new RegExp(D.IMAGE).test(t)?e.blob():t===O.TEXT_PLAIN?yield e.text():t===O.APPLICATION_JSON?yield e.json():Promise.resolve(e.body)}else n=Promise.resolve(e.body)}return n})}static getResponse(e,t,n){return a(this,void 0,void 0,function*(){if(t===T.RAW)return Promise.resolve(e);{const o=yield U.convertResponse(e,t);if(!e.ok)throw o;if("function"!=typeof n)return o;n(null,o)}})}}class k{constructor(e=-1,t=-1){this.minValue=e,this.maxValue=t}}class L{get location(){return this._location}set location(e){this._location=e}get responseBody(){return this._responseBody}set responseBody(e){this._responseBody=e}constructor(e,t){this._location=t,this._responseBody=e}static CreateUploadResult(e,t){return new L(e,t.get("location"))}}class F{static createUploadSession(e,t,n,o={}){return a(this,void 0,void 0,function*(){const r=yield e.api(t).headers(o).post(n);return{url:r.uploadUrl,expiry:new Date(r.expirationDateTime),isCancelled:!1}})}constructor(e,t,n,o={}){if(this.DEFAULT_FILE_SIZE=5242880,this.client=e,!t.sliceFile)throw new d("Please pass the FileUpload object, StreamUpload object or any custom implementation of the FileObject interface");this.file=t,this.file=t,o.rangeSize||(o.rangeSize=this.DEFAULT_FILE_SIZE),this.options=o,this.uploadSession=n,this.nextRange=new k(0,this.options.rangeSize-1)}parseRange(e){const t=e[0];if(void 0===t||""===t)return new k;const n=t.split("-"),o=parseInt(n[0],10);let r=parseInt(n[1],10);return Number.isNaN(r)&&(r=this.file.size-1),new k(o,r)}updateTaskStatus(e){this.uploadSession.expiry=new Date(e.expirationDateTime),this.nextRange=this.parseRange(e.nextExpectedRanges)}getNextRange(){if(-1===this.nextRange.minValue)return this.nextRange;const e=this.nextRange.minValue;let t=e+this.options.rangeSize-1;return t>=this.file.size&&(t=this.file.size-1),new k(e,t)}sliceFile(e){if(console.warn("The LargeFileUploadTask.sliceFile() function has been deprecated and moved into the FileObject interface."),this.file.content instanceof ArrayBuffer||this.file.content instanceof Blob||this.file.content instanceof Uint8Array)return this.file.content.slice(e.minValue,e.maxValue+1);throw new d("The LargeFileUploadTask.sliceFile() function expects only Blob, ArrayBuffer or Uint8Array file content. Please note that the sliceFile() function is deprecated.")}upload(){return a(this,void 0,void 0,function*(){const e=this.options&&this.options.uploadEventHandlers;for(;!this.uploadSession.isCancelled;){const t=this.getNextRange();if(-1===t.maxValue){const e=new Error("Task with which you are trying to upload is already completed, Please check for your uploaded file");throw e.name="Invalid Session",e}const n=yield this.file.sliceFile(t),o=yield this.uploadSliceGetRawResponse(n,t,this.file.size);if(!o)throw new d("Something went wrong! Large file upload slice response is null.");const r=yield U.getResponse(o);if(201===o.status||200===o.status&&r.id)return this.reportProgress(e,t),L.CreateUploadResult(r,o.headers);const i={expirationDateTime:r.expirationDateTime||r.ExpirationDateTime,nextExpectedRanges:r.NextExpectedRanges||r.nextExpectedRanges};this.updateTaskStatus(i),this.reportProgress(e,t)}})}reportProgress(e,t){e&&e.progress&&e.progress(t,e.extraCallbackParam)}uploadSlice(e,t,n){return a(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${n}`,"Content-Type":"application/octet-stream"}).put(e)})}uploadSliceGetRawResponse(e,t,n){return a(this,void 0,void 0,function*(){return yield this.client.api(this.uploadSession.url).headers({"Content-Length":""+(t.maxValue-t.minValue+1),"Content-Range":`bytes ${t.minValue}-${t.maxValue}/${n}`,"Content-Type":"application/octet-stream"}).responseType(T.RAW).put(e)})}cancel(){return a(this,void 0,void 0,function*(){const e=yield this.client.api(this.uploadSession.url).responseType(T.RAW).delete();return 204===e.status&&(this.uploadSession.isCancelled=!0),e})}getStatus(){return a(this,void 0,void 0,function*(){const e=yield this.client.api(this.uploadSession.url).get();return this.updateTaskStatus(e),e})}resume(){return a(this,void 0,void 0,function*(){return yield this.getStatus(),yield this.upload()})}getUploadSession(){return this.uploadSession}}class q{constructor(e,t,n){if(this.content=e,this.name=t,this.size=n,!e||!t||!n)throw new d("Please provide the upload content, name of the file and size of the file")}sliceFile(e){return this.content.slice(e.minValue,e.maxValue+1)}}class j extends F{static constructCreateSessionUrl(e,t=j.DEFAULT_UPLOAD_PATH){return e=e.trim(),""===(t=t.trim())&&(t="/"),"/"!==t[0]&&(t=`/${t}`),"/"!==t[t.length-1]&&(t=`${t}/`),`/me/drive/root:${t.split("/").map(e=>encodeURIComponent(e)).join("/")}${encodeURIComponent(e)}:/createUploadSession`}static getFileInfo(e,t){let n,o;if("undefined"!=typeof Blob&&e instanceof Blob)n=new File([e],t),o=n.size;else if("undefined"!=typeof File&&e instanceof File)n=e,o=n.size;else if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array){const t=e;o=t.byteLength,n=t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}return{content:n,size:o}}static create(e,t,n){return a(this,void 0,void 0,function*(){if(!e||!t||!n)throw new d("Please provide the Graph client instance, file object and OneDriveLargeFileUploadOptions value");const o=n.fileName,r=j.getFileInfo(t,o),i=new q(r.content,o,r.size);return this.createTaskWithFileObject(e,i,n)})}static createTaskWithFileObject(e,t,n){return a(this,void 0,void 0,function*(){if(!e||!t||!n)throw new d("Please provide the Graph client instance, FileObject interface implementation and OneDriveLargeFileUploadOptions value");const o=n.uploadSessionURL?n.uploadSessionURL:j.constructCreateSessionUrl(n.fileName,n.path),r={fileName:n.fileName,fileDescription:n.fileDescription,conflictBehavior:n.conflictBehavior},i=yield j.createUploadSession(e,o,r),a=((e=5242880)=>{const t=62914560;return e>t&&(e=t),(n=e)>327680&&(n=320*Math.floor(n/327680)*1024),n;var n})(n.rangeSize);return new j(e,t,i,{rangeSize:a,uploadEventHandlers:n.uploadEventHandlers})})}static createUploadSession(e,t,n){const o=Object.create(null,{createUploadSession:{get:()=>super.createUploadSession}});return a(this,void 0,void 0,function*(){const r={item:{"@microsoft.graph.conflictBehavior":(null==n?void 0:n.conflictBehavior)||"rename",name:null==n?void 0:n.fileName,description:null==n?void 0:n.fileDescription}};return o.createUploadSession.call(this,e,t,r)})}constructor(e,t,n,o){super(e,t,n,o)}commit(e,t="rename"){return a(this,void 0,void 0,function*(){const n={name:this.file.name,"@microsoft.graph.conflictBehavior":t,"@microsoft.graph.sourceUrl":this.uploadSession.url};return yield this.client.api(e).put(n)})}}j.DEFAULT_UPLOAD_PATH="/";class H{constructor(e){this.provider=e}getAccessToken(){return a(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.provider((n,o)=>a(this,void 0,void 0,function*(){if(o)e(o);else{n||(n=new d("Access token is undefined or empty.\t\t\t\t\t\tPlease provide a valid token.\t\t\t\t\t\tFor more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md"));const e=yield d.setGraphClientError(n);t(e)}}))})})}}class B extends Error{constructor(e=-1,t,n){super(t||n&&n.message),Object.setPrototypeOf(this,B.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=n?n.stack:this.stack}}class ${static constructError(e,t,n){const o=new B(t,"",e);return void 0!==e.name&&(o.code=e.name),o.body=e.toString(),o.date=new Date,o.headers=null==n?void 0:n.headers,o}static constructErrorFromResponse(e,t,n){const o=e.error,r=new B(t,o.message);return r.code=o.code,void 0!==o.innerError&&(r.requestId=o.innerError["request-id"],r.date=new Date(o.innerError.date)),r.body=JSON.stringify(o),r.headers=null==n?void 0:n.headers,r}static getError(e=null,t=-1,n,o){return a(this,void 0,void 0,function*(){let r;if(e&&e.error?r=$.constructErrorFromResponse(e,t,o):e instanceof Error?r=$.constructError(e,t,o):(r=new B(t),r.body=e),"function"!=typeof n)return r;n(r,null)})}}class Q{constructor(e,t,n){this.parsePath=e=>{if(-1!==e.indexOf("https://")){const t=(e=e.replace("https://","")).indexOf("/");-1!==t&&(this.urlComponents.host="https://"+e.substring(0,t),e=e.substring(t+1,e.length));const n=e.indexOf("/");-1!==n&&(this.urlComponents.version=e.substring(0,n),e=e.substring(n+1,e.length))}"/"===e.charAt(0)&&(e=e.substr(1));const t=e.indexOf("?");if(-1===t)this.urlComponents.path=e;else{this.urlComponents.path=e.substr(0,t);const n=e.substring(t+1,e.length).split("&");for(const e of n)this.parseQueryParameter(e)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(n)}addCsvQueryParameter(e,t,n){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let o=[];n.length>1&&"string"==typeof t?o=Array.prototype.slice.call(n):"string"==typeof t?o.push(t):o=o.concat(t),this.urlComponents.oDataQueryParams[e]+=o.join(",")}buildFullUrl(){const e=(e=>{const t=e=>e.replace(/^\/+/,"");return Array.prototype.slice.call(e).reduce((e,n)=>{return[(o=e,o.replace(/\/+$/,"")),t(n)].join("/");var o})})([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(0!==Object.keys(e.oDataQueryParams).length)for(const n in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,n)&&t.push(n+"="+e.oDataQueryParams[n]);if(0!==Object.keys(e.otherURLQueryParams).length)for(const n in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,n)&&t.push(n+"="+e.otherURLQueryParams[n]);if(0!==e.otherURLQueryOptions.length)for(const n of e.otherURLQueryOptions)t.push(n);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if("string"==typeof e)if("?"===e.charAt(0)&&(e=e.substring(1)),-1!==e.indexOf("&")){const t=e.split("&");for(const e of t)this.parseQueryParamenterString(e)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),n=e.substring(0,t),o=e.substring(t+1);this.setURLComponentsQueryParamater(n,o)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(-1!==l.indexOf(e)){const n=this.urlComponents.oDataQueryParams[e],o=n&&("$expand"===e||"$select"===e||"$orderby"===e);this.urlComponents.oDataQueryParams[e]=o?n+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");return-1!==t&&!(-1!==e.indexOf("(")&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(void 0!==this.config.fetchOptions){const t=Object.assign({},this.config.fetchOptions);Object.assign(e,t),void 0!==typeof this.config.fetchOptions.headers&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),void 0!==e.headers&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,n){var o;return a(this,void 0,void 0,function*(){let r;const i=new y(this._middlewareOptions);this.updateRequestOptions(t);const a=null===(o=this.config)||void 0===o?void 0:o.customHosts;try{return r=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:i,customHosts:a})).response,yield U.getResponse(r,this._responseType,n)}catch(e){if(e instanceof d)throw e;let t;throw r&&(t=r.status),yield $.getError(e,t,n,r)}})}setHeaderContentType(){if(!this._headers)return void this.header("Content-Type","application/json");const e=Object.keys(this._headers);for(const t of e)if("content-type"===t.toLowerCase())return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return a(this,void 0,void 0,function*(){const t=this.buildFullUrl(),o={method:n.GET};return yield this.send(t,o,e)})}post(e,t){return a(this,void 0,void 0,function*(){const o=this.buildFullUrl(),r={method:n.POST,body:u(e)};return"FormData"===(e&&e.constructor&&e.constructor.name)?r.headers={}:(this.setHeaderContentType(),r.headers=this._headers),yield this.send(o,r,t)})}create(e,t){return a(this,void 0,void 0,function*(){return yield this.post(e,t)})}put(e,t){return a(this,void 0,void 0,function*(){const o=this.buildFullUrl();this.setHeaderContentType();const r={method:n.PUT,body:u(e)};return yield this.send(o,r,t)})}patch(e,t){return a(this,void 0,void 0,function*(){const o=this.buildFullUrl();this.setHeaderContentType();const r={method:n.PATCH,body:u(e)};return yield this.send(o,r,t)})}update(e,t){return a(this,void 0,void 0,function*(){return yield this.patch(e,t)})}delete(e){return a(this,void 0,void 0,function*(){const t=this.buildFullUrl(),o={method:n.DELETE};return yield this.send(t,o,e)})}del(e){return a(this,void 0,void 0,function*(){return yield this.delete(e)})}getStream(e){return a(this,void 0,void 0,function*(){const t=this.buildFullUrl(),o={method:n.GET};return this.responseType(T.STREAM),yield this.send(t,o,e)})}putStream(e,t){return a(this,void 0,void 0,function*(){const o=this.buildFullUrl(),r={method:n.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(o,r,t)})}}class X{constructor(...e){if(!e||!e.length){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Please provide a default middleware chain or custom middleware chain",e}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach((t,n)=>{n<e.length-1&&t.setNext(e[n+1])}),this.middleware=e[0]}sendRequest(e){return a(this,void 0,void 0,function*(){if("string"==typeof e.request&&void 0===e.options){const e=new Error;throw e.name="InvalidRequestOptions",e.message="Unable to execute the middleware, Please provide valid options for a request",e}return yield this.middleware.execute(e),e})}}class G{execute(e){return a(this,void 0,void 0,function*(){e.response=yield fetch(e.request,e.options)})}}class z{static createWithAuthenticationProvider(e){const t=new S(e),n=new C(new N),o=new I,r=new G;if(t.setNext(n),"object"==typeof process){const e=new M(new _);n.setNext(e),e.setNext(o)}else n.setNext(o);return o.setNext(r),z.createWithMiddleware(t)}static createWithMiddleware(...e){return new X(...e)}}class W{static init(e){const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]="authProvider"===n?new H(e[n]):e[n]);return W.initWithMiddleware(t)}static initWithMiddleware(e){return new W(e)}constructor(e){this.config={baseUrl:"https://graph.microsoft.com/",debugLogging:!1,defaultVersion:"v1.0"},(()=>{if("undefined"==typeof Promise&&"undefined"==typeof fetch){const e=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof Promise){const e=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}if("undefined"==typeof fetch){const e=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw e.name="PolyFillNotAvailable",e}})();for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this.config[t]=e[t]);let t;if(void 0!==e.authProvider&&void 0!==e.middleware){const e=new Error;throw e.name="AmbiguityInInitialization",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",e}if(void 0!==e.authProvider)t=z.createWithAuthenticationProvider(e.authProvider);else{if(void 0===e.middleware){const e=new Error;throw e.name="InvalidMiddlewareChain",e.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",e}t=new X(...[].concat(e.middleware))}this.httpClient=t}api(e){return new Q(this.httpClient,this.config,e)}}function V(e){return V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},V(e)}function Y(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var c=o&&o.prototype instanceof s?o:s,d=Object.create(c.prototype);return Z(d,"_invoke",function(n,o,r){var i,s,c,d=0,l=r||[],u=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,s=0,c=e,p.n=n,a}};function h(n,o){for(s=n,c=o,t=0;!u&&d&&!r&&t<l.length;t++){var r,i=l[t],h=p.p,f=i[2];n>3?(r=f===o)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((r=n<2&&h<i[1])?(s=0,p.v=o,p.n=i[1]):h<f&&(r=n<3||i[0]>o||o>f)&&(i[4]=n,i[5]=o,p.n=f,s=0))}if(r||n>1)return a;throw u=!0,o}return function(r,l,f){if(d>1)throw TypeError("Generator is already running");for(u&&1===l&&h(l,f),s=l,c=f;(t=s<2?e:c)||!u;){i||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(d=2,i){if(s||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),s=1);i=e}else if((t=(u=p.n<0)?c:n.call(o,p))!==a)break}catch(t){i=e,s=1,c=t}finally{d=1}}return{value:t,done:u}}}(n,r,i),!0),d}var a={};function s(){}function c(){}function d(){}t=Object.getPrototypeOf;var l=[][o]?t(t([][o]())):(Z(t={},o,function(){return this}),t),u=d.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,Z(e,r,"GeneratorFunction")),e.prototype=Object.create(u),e}return c.prototype=d,Z(u,"constructor",d),Z(d,"constructor",c),c.displayName="GeneratorFunction",Z(d,r,"GeneratorFunction"),Z(u),Z(u,r,"Generator"),Z(u,o,function(){return this}),Z(u,"toString",function(){return"[object Generator]"}),(Y=function(){return{w:i,m:p}})()}function Z(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}Z=function(e,t,n,o){function i(t,n){Z(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},Z(e,t,n,o)}function K(e,t,n,o,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function J(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function a(e){K(i,o,r,a,s,"next",e)}function s(e){K(i,o,r,a,s,"throw",e)}a(void 0)})}}function ee(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,te(o.key),o)}}function te(e){var t=function(e){if("object"!=V(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=V(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==V(t)?t:t+""}var ne=["Files.ReadWrite.All"],oe=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},t=[{key:"getAccessToken",value:(n=J(Y().m(function e(){var t,n;return Y().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,Office.auth.getAccessToken({allowSignInPrompt:!0,allowConsentPrompt:!0,forMSGraphAccess:!0,scopes:ne});case 1:return t=e.v,console.log("[GRAPH API] Access token acquired successfully."),e.a(2,t);case 2:throw e.p=2,n=e.v,console.error("[GRAPH API] Failed to acquire access token:",n.message),n;case 3:return e.a(2)}},e,null,[[0,2]])})),function(){return n.apply(this,arguments)})}],t&&ee(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function re(){return ie.apply(this,arguments)}function ie(){return(ie=J(Y().m(function e(){var t,n;return Y().w(function(e){for(;;)if(0===e.n)return t=new oe,n=W.initWithMiddleware({authProvider:t}),e.a(2,n)},e)}))).apply(this,arguments)}function ae(e,t){return se.apply(this,arguments)}function se(){return(se=J(Y().m(function e(t,n){var o,r,i,a,s,c,d,l;return Y().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,re();case 1:return o=e.v,r="/me/drive/special/approot:/uploaded-images/".concat(n,":/content"),e.n=2,fetch(t);case 2:return i=e.v,e.n=3,i.blob();case 3:return a=e.v,e.p=4,e.n=5,o.api("/me/drive/special/approot:/uploaded-images").get();case 5:e.n=7;break;case 6:return e.p=6,e.v,e.n=7,o.api("/me/drive/special/approot/children").post({name:"uploaded-images",folder:{}});case 7:return e.n=8,o.api(r).put(a);case 8:return s=e.v,c=s.id,e.n=9,o.api("/me/drive/items/".concat(c,"/createLink")).post({type:"view",scope:"anonymous"});case 9:return d=e.v,e.a(2,d.link.webUrl);case 10:return e.p=10,l=e.v,console.error("Graph API error:",l),e.a(2,null)}},e,null,[[4,6],[0,10]])}))).apply(this,arguments)}function ce(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var c=o&&o.prototype instanceof s?o:s,d=Object.create(c.prototype);return de(d,"_invoke",function(n,o,r){var i,s,c,d=0,l=r||[],u=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,s=0,c=e,p.n=n,a}};function h(n,o){for(s=n,c=o,t=0;!u&&d&&!r&&t<l.length;t++){var r,i=l[t],h=p.p,f=i[2];n>3?(r=f===o)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((r=n<2&&h<i[1])?(s=0,p.v=o,p.n=i[1]):h<f&&(r=n<3||i[0]>o||o>f)&&(i[4]=n,i[5]=o,p.n=f,s=0))}if(r||n>1)return a;throw u=!0,o}return function(r,l,f){if(d>1)throw TypeError("Generator is already running");for(u&&1===l&&h(l,f),s=l,c=f;(t=s<2?e:c)||!u;){i||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(d=2,i){if(s||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),s=1);i=e}else if((t=(u=p.n<0)?c:n.call(o,p))!==a)break}catch(t){i=e,s=1,c=t}finally{d=1}}return{value:t,done:u}}}(n,r,i),!0),d}var a={};function s(){}function c(){}function d(){}t=Object.getPrototypeOf;var l=[][o]?t(t([][o]())):(de(t={},o,function(){return this}),t),u=d.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,de(e,r,"GeneratorFunction")),e.prototype=Object.create(u),e}return c.prototype=d,de(u,"constructor",d),de(d,"constructor",c),c.displayName="GeneratorFunction",de(d,r,"GeneratorFunction"),de(u),de(u,r,"Generator"),de(u,o,function(){return this}),de(u,"toString",function(){return"[object Generator]"}),(ce=function(){return{w:i,m:p}})()}function de(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}de=function(e,t,n,o){function i(t,n){de(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},de(e,t,n,o)}function le(e,t,n,o,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function ue(e,t){return pe.apply(this,arguments)}function pe(){var e;return e=ce().m(function e(t,n){var r,i,a,s,c,d,l,u,p;return ce().w(function(e){for(;;)switch(e.n){case 0:if(r=o[t]){e.n=1;break}return e.a(2);case 1:if(i={},r.variables.forEach(function(e){var t;i[e.name]=(null===(t=document.getElementById(e.name))||void 0===t?void 0:t.value)||"{{".concat(e.name,"}}")}),i.documentName=r.documentName,i.documentShortText="function"==typeof r.documentShortText?r.documentShortText(i):r.documentShortText,a=r.subject(i),s=Office.context.mailbox.item,c=s.itemType===Office.MailboxEnums.ItemType.Message&&"function"==typeof s.body.setSelectedDataAsync,"keyFob"!==t||!n){e.n=3;break}return d="keyFobImage-".concat(Date.now(),".jpg"),e.n=2,ae(n,d);case 2:l=e.v,i.keyFobImage=l||"The key fob image could not be embedded. Please insert it manually or check your permissions.",u=r.body(i),c?(s.body.setSelectedDataAsync(u,{coercionType:Office.CoercionType.Html}),s.subject.setSelectedDataAsync(a,{coercionType:Office.CoercionType.Text})):s.displayReplyAllFormAsync({htmlBody:u,subject:a}),e.n=4;break;case 3:p=r.body(i),c?(s.body.setSelectedDataAsync(p,{coercionType:Office.CoercionType.Html}),s.subject.setSelectedDataAsync(a,{coercionType:Office.CoercionType.Text})):s.displayReplyAllFormAsync({htmlBody:p,subject:a});case 4:return e.a(2)}},e)}),pe=function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function a(e){le(i,o,r,a,s,"next",e)}function s(e){le(i,o,r,a,s,"throw",e)}a(void 0)})},pe.apply(this,arguments)}function he(){var e,t,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function i(n,o,r,i){var c=o&&o.prototype instanceof s?o:s,d=Object.create(c.prototype);return fe(d,"_invoke",function(n,o,r){var i,s,c,d=0,l=r||[],u=!1,p={p:0,n:0,v:e,a:h,f:h.bind(e,4),d:function(t,n){return i=t,s=0,c=e,p.n=n,a}};function h(n,o){for(s=n,c=o,t=0;!u&&d&&!r&&t<l.length;t++){var r,i=l[t],h=p.p,f=i[2];n>3?(r=f===o)&&(c=i[(s=i[4])?5:(s=3,3)],i[4]=i[5]=e):i[0]<=h&&((r=n<2&&h<i[1])?(s=0,p.v=o,p.n=i[1]):h<f&&(r=n<3||i[0]>o||o>f)&&(i[4]=n,i[5]=o,p.n=f,s=0))}if(r||n>1)return a;throw u=!0,o}return function(r,l,f){if(d>1)throw TypeError("Generator is already running");for(u&&1===l&&h(l,f),s=l,c=f;(t=s<2?e:c)||!u;){i||(s?s<3?(s>1&&(p.n=-1),h(s,c)):p.n=c:p.v=c);try{if(d=2,i){if(s||(r="next"),t=i[r]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,s<2&&(s=0)}else 1===s&&(t=i.return)&&t.call(i),s<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),s=1);i=e}else if((t=(u=p.n<0)?c:n.call(o,p))!==a)break}catch(t){i=e,s=1,c=t}finally{d=1}}return{value:t,done:u}}}(n,r,i),!0),d}var a={};function s(){}function c(){}function d(){}t=Object.getPrototypeOf;var l=[][o]?t(t([][o]())):(fe(t={},o,function(){return this}),t),u=d.prototype=s.prototype=Object.create(l);function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,fe(e,r,"GeneratorFunction")),e.prototype=Object.create(u),e}return c.prototype=d,fe(u,"constructor",d),fe(d,"constructor",c),c.displayName="GeneratorFunction",fe(d,r,"GeneratorFunction"),fe(u),fe(u,r,"Generator"),fe(u,o,function(){return this}),fe(u,"toString",function(){return"[object Generator]"}),(he=function(){return{w:i,m:p}})()}function fe(e,t,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}fe=function(e,t,n,o){function i(t,n){fe(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[t]=n:(i("next",0),i("throw",1),i("return",2))},fe(e,t,n,o)}function me(e,t,n,o,r,i,a){try{var s=e[i](a),c=s.value}catch(e){return void n(e)}s.done?t(c):Promise.resolve(c).then(o,r)}function ye(e){return function(){var t=this,n=arguments;return new Promise(function(o,r){var i=e.apply(t,n);function a(e){me(i,o,r,a,s,"next",e)}function s(e){me(i,o,r,a,s,"throw",e)}a(void 0)})}}"undefined"!=typeof window&&(window.Office=Office,window.Client=W);var ge=null;Office.onReady(function(){window.onload=function(){!function(){var e=document.getElementById("templateSelect");document.getElementById("sideload-msg").style.display="none",Object.keys(o).forEach(function(t){var n=document.createElement("option");n.value=t,n.textContent=o[t].name,e.appendChild(n)}),i(e.value),r();var t=document.getElementById("imageUploadContainer"),n=document.getElementById("imageUpload"),a=function(){"keyFob"===e.value?t.style.display="block":t.style.display="none"};e.addEventListener("change",function(){i(e.value),r(),a()}),a(),n.addEventListener("change",function(e){var t=e.target.files[0];if(t){var n=new FileReader;n.onload=function(e){var t=new Image;t.onload=function(){if("undefined"!=typeof cv){var e=cv.imread(t),n=new cv.Mat,o=new cv.Size(0,0),i=600,a=e.cols,s=e.rows;a>s?(s=Math.round(s*i/a),a=i):(a=Math.round(a*i/s),s=i),cv.resize(e,n,o,a/e.cols,s/e.rows,cv.INTER_AREA),cv.imshow("imageCanvas",n);var c=document.getElementById("imageCanvas");ge=c.toDataURL("image/jpeg",.8),e.delete(),n.delete(),r()}else console.error("OpenCV.js is not loaded.")},t.src=e.target.result},n.readAsDataURL(t)}}),document.getElementById("pasteButton").addEventListener("click",ye(he().m(function t(){return he().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,ue(e.value,ge);case 1:return t.a(2)}},t)})))}()}})}()}();
//# sourceMappingURL=taskpane.js.map